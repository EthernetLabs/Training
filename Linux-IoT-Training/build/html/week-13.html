

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Week-13 LINUX IoT Training &mdash; LIT 1.1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="LIT 1.1 documentation" href="index.html"/>
        <link rel="next" title="Settings GNU-Plot" href="appendix.html"/>
        <link rel="prev" title="Week 11-12 Linux IoT Training" href="week-12.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> LIT
          

          
          </a>

          
            
            
              <div class="version">
                1.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="week-01.html">Week-1 Linux IoT Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="week-02.html">Week - 2 Linux IoT Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="week-03.html">Week - 3 Linux IoT Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="week-04.html">Week - 4 Linux IoT Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="week-05.html">Week - 5 Linux-IoT Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="week-06.html">Week - 6 Linux IoT Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="week-07.html">Week - 7 Linux IoT Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="week-08.html">Week - 8 Linux IoT Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="week-09.html">Week - 9 Linux IoT Project</a></li>
<li class="toctree-l1"><a class="reference internal" href="week-10.html">Week - 10 IoT Protocols: RESTful APIs and COAP</a></li>
<li class="toctree-l1"><a class="reference internal" href="week-12.html">Week 11-12 Linux IoT Training</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Week-13 LINUX IoT Training</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#database-creation-management-and-backups">DATABASE CREATION , MANAGEMENT AND BACKUPS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#database-configuration">Database Configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#vm-1-ip-192-168-122-13">VM – 1 (IP:192.168.122.13)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#vm-2-ip-192-168-122-10">VM – 2 (IP: 192.168.122.10)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#configuring-attacking-and-securing-vrrp-on-linux">Configuring, Attacking and Securing VRRP on Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="#what-is-keepalived">What is Keepalived</a></li>
<li class="toctree-l2"><a class="reference internal" href="#vm-3-ip-192-168-122-11">VM – 3 (IP: 192.168.122.11)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#vm-4-ip-192-168-122-9">VM – 4 (IP: 192.168.122.9)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#network-filesystem-nfs">Network Filesystem - NFS</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="appendix.html">Settings GNU-Plot</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">LIT</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Week-13 LINUX IoT Training</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/week-13.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="week-13-linux-iot-training">
<span id="week-13"></span><h1>Week-13 LINUX IoT Training<a class="headerlink" href="#week-13-linux-iot-training" title="Permalink to this headline">¶</a></h1>
<div class="section" id="database-creation-management-and-backups">
<h2>DATABASE CREATION , MANAGEMENT AND BACKUPS<a class="headerlink" href="#database-creation-management-and-backups" title="Permalink to this headline">¶</a></h2>
<p>On ZMQ client on one of the virtual machines VM-1 that stores the IoT Gateway Messages in a queue. Create a mysql database named “LITdb” in another VM-2 (IP = 192.168.122.10). Write a code in python in VM-1 that can connect to remote database at VM-2 and can create a table “LITFRAME” so that remote database can be updated according to the IoT Gateway Messages. We need one more VM named as VM-3 that will work as BACKUP DATABASE. Hence, it is necessary that VM-3 should sync its database with VM-2 database. If somehow, VM-2 shuts off, VM-3 will receive data and update its database, so that whenever, VM-2 wakes-up it should recover all the important messages that it have misses during the die-off period.</p>
<div class="figure align-center" id="is-sweaty">
<img alt="_images/DATABASE_MANAGEMENT_TOPPLOGY.png" src="_images/DATABASE_MANAGEMENT_TOPPLOGY.png" />
</div>
<div class="section" id="database-configuration">
<h3>Database Configuration<a class="headerlink" href="#database-configuration" title="Permalink to this headline">¶</a></h3>
<div class="section" id="vm-1-ip-192-168-122-13">
<h4>VM – 1 (IP:192.168.122.13)<a class="headerlink" href="#vm-1-ip-192-168-122-13" title="Permalink to this headline">¶</a></h4>
<ol class="arabic simple">
<li>Install MySQL.</li>
<li>Write a python code named ZMQ_Client that receives messages from IoT Gateway. Store it in a  queue. Then, update the local database based on that queue.</li>
<li>Code is provided on github. <a class="reference external" href="https://github.com/LinuxIoT/python-dev">https://github.com/LinuxIoT/python-dev</a></li>
</ol>
</div>
<div class="section" id="vm-2-ip-192-168-122-10">
<h4>VM – 2 (IP: 192.168.122.10)<a class="headerlink" href="#vm-2-ip-192-168-122-10" title="Permalink to this headline">¶</a></h4>
<p>#.Install MySQL</p>
<ol class="arabic">
<li><dl class="first docutils">
<dt>Start with editing mysql config file.</dt>
<dd><p class="first last"><cite>vim /etc/mysql/my.cnf</cite>
<cite>bind-address           = 0.0.0.0</cite></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Restart mysql server.</dt>
<dd><p class="first last"><cite>service mysql restart</cite></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Create a database named as “ LITdb”.</dt>
<dd><ul class="first last">
<li><p class="first">mysql -u root -p</p>
</li>
<li><p class="first">CREATE DATABASE LITdb;</p>
</li>
<li><p class="first">USE LITdb;</p>
</li>
<li><dl class="first docutils">
<dt>Change Privileges or give privileges to remote user.</dt>
<dd><p class="first last"><a class="reference external" href="https://easyengine.io/tutorials/mysql/remote-access/">https://easyengine.io/tutorials/mysql/remote-access/</a></p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Test at remote station (VM-1) by executing following command that it can access the database         or not.</dt>
<dd><p class="first last"><cite>mysql -h HOST -u USERNAME -pPASSWORD</cite></p>
</dd>
</dl>
</li>
</ol>
</div>
</div>
</div>
<div class="section" id="configuring-attacking-and-securing-vrrp-on-linux">
<h2>Configuring, Attacking and Securing VRRP on Linux<a class="headerlink" href="#configuring-attacking-and-securing-vrrp-on-linux" title="Permalink to this headline">¶</a></h2>
<p>We will configure VIRTUAL - IP = 192.168.122.12
<a class="reference external" href="http://louwrentius.com/configuring-attacking-and-securing-vrrp-on-linux.html">http://louwrentius.com/configuring-attacking-and-securing-vrrp-on-linux.html</a></p>
</div>
<div class="section" id="what-is-keepalived">
<h2>What is Keepalived<a class="headerlink" href="#what-is-keepalived" title="Permalink to this headline">¶</a></h2>
<p>Keepalived is a routing software written in C. The main goal of this project is to provide simple and robust facilities for load-balancing and high-availability to Linux system and Linux based infrastructures.
<a class="reference external" href="http://keepalived.org/">http://keepalived.org/</a></p>
<dl class="docutils">
<dt><strong>What is the requirement for installing or running Load-Balancer like keepalived or Linux-HA?</strong></dt>
<dd>Load balancing in HAProxy and Keepalived at the same time also requires the ability to bind to an IP address that are nonlocal, meaning that it is not assigned to a device on the local system. This allows a running load balancer instance to bind to a an IP that is not local for failover.</dd>
</dl>
<p>To enable, edit the line in /etc/sysctl.conf that reads net.ipv4.ip_nonlocal_bind to the following:
net.ipv4.ip_nonlocal_bind = 1
sysctl -p
<a class="reference external" href="https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/7/html/Load_Balancer_Administration/s1-initial-setup-forwarding-VSA.html">https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/7/html/Load_Balancer_Administration/s1-initial-setup-forwarding-VSA.html</a></p>
<p><strong>ISCSI Initiator settings:</strong>
<a class="reference external" href="https://help.ubuntu.com/lts/serverguide/iscsi-initiator.html">https://help.ubuntu.com/lts/serverguide/iscsi-initiator.html</a>
<a class="reference external" href="https://www.howtoforge.com/using-iscsi-on-ubuntu-10.04-initiator-and-target">https://www.howtoforge.com/using-iscsi-on-ubuntu-10.04-initiator-and-target</a></p>
</div>
<div class="section" id="vm-3-ip-192-168-122-11">
<h2>VM – 3 (IP: 192.168.122.11)<a class="headerlink" href="#vm-3-ip-192-168-122-11" title="Permalink to this headline">¶</a></h2>
<p>Same Procedure with VM-3 as we done for VM-2.</p>
</div>
<div class="section" id="vm-4-ip-192-168-122-9">
<h2>VM – 4 (IP: 192.168.122.9)<a class="headerlink" href="#vm-4-ip-192-168-122-9" title="Permalink to this headline">¶</a></h2>
<ul>
<li><dl class="first docutils">
<dt>The two dominant IP storage protocols used in virtualization</dt>
<dd><p class="first last">→ NFS
→ ISCSI</p>
</dd>
</dl>
</li>
</ul>
<p><strong>What is iSCSI?</strong></p>
<p>It is a network storage protocol above TCP/IP. This protocol encapsulates SCSI data into TCP packets.
<a class="reference external" href="https://www.howtoforge.com/iscsi_on_linux">https://www.howtoforge.com/iscsi_on_linux</a></p>
<p><strong>ISCSI – Target Installation – SERVER:</strong></p>
<p>Follow this link for server installation:
<a class="reference external" href="https://www.howtoforge.com/using-iscsi-on-ubuntu-10.04-initiator-and-target">https://www.howtoforge.com/using-iscsi-on-ubuntu-10.04-initiator-and-target</a></p>
<p>sudo apt-get update
sudo apt-get install iscsitarget iscsitarget-source iscsitarget-dkms</p>
<p><strong>→ iscsitaget-source failed -  FiX</strong></p>
<p><a class="reference external" href="http://installion.co.uk/ubuntu/precise/universe/i/iscsitarget-source/install/index.html">http://installion.co.uk/ubuntu/precise/universe/i/iscsitarget-source/install/index.html</a></p>
<p>First, check that the universe repository is enabled by inspecting &#8216;/etc/apt/sources.list&#8217; with your favourite editor.
You will need to use sudo to ensure that you have permissions to edit the file.
sudo gedit /etc/apt/sources.list
If universe is not included then modify the file so that it does.
deb <a class="reference external" href="http://us.archive.ubuntu.com/ubuntu">http://us.archive.ubuntu.com/ubuntu</a> precise main universe
After any changes you should run this command to update your system.
<cite>sudo apt-get update</cite>
<cite>You can now install the package like this.</cite>
<cite>sudo apt-get install iscsitarget-source</cite></p>
<p><strong>Again ERROR:</strong></p>
<dl class="docutils">
<dt><a class="reference external" href="mailto:user&#37;&#52;&#48;ubuntu">user<span>&#64;</span>ubuntu</a>:~$ sudo service iscsitarget restart</dt>
<dd><ul class="first last simple">
<li>Removing iSCSI enterprise target devices:           [ OK ]</li>
<li>Starting iSCSI enterprise target service            FATAL: Module iscsi_trgt not found.</li>
</ul>
</dd>
</dl>
<p><strong>HOW TO FIX:</strong></p>
<p><a class="reference external" href="http://sysadmin.wikia.com/wiki/Server_side_iscsi_linux">http://sysadmin.wikia.com/wiki/Server_side_iscsi_linux</a></p>
<p>The error is normal, because we still didn&#8217;t build the module to use for iSCSI. So, let&#8217;s do it. To install this new kernel module, you will need to install two packages&nbsp;:
# apt-get install module-assistant debhelper
And now, you are able to build the new kernel module to enable iSCSI target. Let&#8217;s build the kernel module with this command&nbsp;:
# m-a a-i iscsitarget
If all goes properly, we, now, have to load this new kernel module. Let&#8217;s do it with this command&nbsp;:
# modprobe iscsi_trgt
You can known configure your iSCSI target on Debian here.</p>
<p><strong>Differences Between NFS and iSCSI</strong></p>
<p><a class="reference external" href="https://www.usenix.org/legacy/events/fast04/tech/full_papers/radkov/radkov_html/node5.html">https://www.usenix.org/legacy/events/fast04/tech/full_papers/radkov/radkov_html/node5.html</a>
<a class="reference external" href="http://www.infoworld.com/article/2616802/infrastructure-storage/your-fateful-decision--nfs-or-iscsi-.html">http://www.infoworld.com/article/2616802/infrastructure-storage/your-fateful-decision&#8211;nfs-or-iscsi-.html</a></p>
<p>NFS and iSCSI provide fundamentally different data sharing semantics. NFS is inherently suitable for data sharing, since it enable files to be shared among multiple client machines. In contrast, a block protocol such as iSCSI supports a single client for each volume on the block server. Consequently, iSCSI permits applications running on a single client machine to share remote data, but it is not directly suitable for sharing data across machines. It is possible, however, to employ iSCSI in shared multi-client environments by designing an appropriate distributed file system that runs on multiple clients and accesses data from block server.
The implications of caching are also different in the two scenarios. In NFS, the file system is located at the server and so is the file system cache (hits in this cache incur a network hop). NFS clients also employ a cache that can hold both data and meta-data. To ensure consistency across clients, NFS v2 and v3 require that client perform consistency checks with the server on cached data and meta-data. The validity of cached data at the client is implementation-dependent&#8211;in Linux, cached meta-data is treated as potentially stale after 3 seconds and cached data after 30 seconds. Thus, meta-data and data reads may trigger a message exchange (i.e., a consistency check) with the server even in the event of a cache hit. NFS v4 can avoid this message exchange for data reads if the server supports file delegation. From the perspective of writes, both data and meta-data writes in NFS v2 are synchronous. NFS v3 and v4 supports asynchronous data writes, but meta-data updates continue to be synchronous. Thus, depending on the version, NFS has different degrees of write-through caching.
In iSCSI, the caching policy is governed by the file system. Since the file system cache is located at the client, both data and meta-data reads benefit from any cached content. Data updates are asynchronous in most file systems. In modern file systems, meta-data updates are also asynchronous, since such systems use log-based journaling for faster recovery. In the ext3 file system, for instance, meta-data is written asynchronously at commit points. The asynchrony and frequency of these commit points is a trade-off between recovery and performance (ext3 uses a commit interval of 5 seconds). Thus, when used in conjunction with ext3, iSCSI supports a fully write-back cache for data and meta-data updates.
Observe that the benefits of asynchronous meta-data update in iSCSI come at the cost of lower reliability of data and meta-data persistence than in NFS. Due to synchronous meta-data updates in NFS, both data and meta-data updates persist across client failure. However, in iSCSI, meta-data updates as well as related data may be lost in case client fails prior to flushing the journal and data blocks to the iSCSI server.</p>
</div>
<div class="section" id="network-filesystem-nfs">
<h2>Network Filesystem - NFS<a class="headerlink" href="#network-filesystem-nfs" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://linuxconfig.org/how-to-configure-nfs-on-linux">https://linuxconfig.org/how-to-configure-nfs-on-linux</a>
- <cite>apt-get install nfs-common (Both Server and Client)</cite></p>
<p><strong>Server</strong>
- <cite>apt-get install nfs-kernel-server (Server)</cite>
- <cite>echo &#8216;/home/nfs/ *(ro,sync)&#8217; &gt; /etc/exports</cite>
- <cite>vim /home/nfs/nfs-test-files</cite>
- <cite>sudo service  nfs-kernel-server restart</cite></p>
<p><strong>Client</strong></p>
<ul class="simple">
<li><cite>mkdir /home/nfs_local</cite></li>
<li><cite>mount IP-Address:/home/nfs /home/nfs_local</cite></li>
</ul>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="appendix.html" class="btn btn-neutral float-right" title="Settings GNU-Plot" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="week-12.html" class="btn btn-neutral" title="Week 11-12 Linux IoT Training" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Linux IoT.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>